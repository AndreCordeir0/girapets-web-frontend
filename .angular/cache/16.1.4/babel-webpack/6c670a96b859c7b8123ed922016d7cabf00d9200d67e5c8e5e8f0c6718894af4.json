{"ast":null,"code":"import { forwardRef } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup, NG_VALIDATORS, NG_VALUE_ACCESSOR, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"primeng/api\";\nimport * as i2 from \"../../shared/services/animais.service\";\nimport * as i3 from \"./../../shared/components/loading-service.service\";\nimport * as i4 from \"primeng/dynamicdialog\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"primeng/inputtext\";\nimport * as i7 from \"@angular/forms\";\nfunction AdicionarAnimalComponent_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Imagens a serem adicionadas: \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AdicionarAnimalComponent_img_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 28);\n  }\n  if (rf & 2) {\n    const image_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"src\", image_r3 == null ? null : image_r3.url, i0.ɵɵsanitizeUrl)(\"alt\", image_r3.name);\n  }\n}\nlet AdicionarAnimalComponent = /*#__PURE__*/(() => {\n  class AdicionarAnimalComponent {\n    constructor(messageService, animaisService, loadingService, ref) {\n      this.messageService = messageService;\n      this.animaisService = animaisService;\n      this.loadingService = loadingService;\n      this.ref = ref;\n      this.uploadedFiles = [];\n      this.formData = new FormData();\n      this.selectedImages = [];\n      this.uploadedImages = [];\n      this.formDataAnimal = new FormData();\n      this.animaisFormGroup = new FormGroup({\n        nome: new FormControl(null, Validators.required),\n        especie: new FormControl(null, Validators.required),\n        sexo: new FormControl(null, Validators.required),\n        raça: new FormControl(null, Validators.required),\n        idade: new FormControl(null, Validators.required),\n        descricao: new FormControl(null, Validators.required),\n        cidade: new FormControl(null, Validators.required)\n      });\n      this.onTouched = () => {};\n      this.onChange = () => {};\n    }\n    ngOnInit() {}\n    onUpload(event) {\n      for (let file of event.files) {\n        this.uploadedFiles.push(file);\n      }\n      this.messageService.add({\n        severity: 'info',\n        summary: 'File Uploaded',\n        detail: ''\n      });\n    }\n    onFileSelected(event) {\n      const files = event.target.files;\n      const allowedExtensions = ['.jpg', '.jpeg', '.png'];\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        const fileExtension = file.name.split('.').pop().toLowerCase();\n        if (!allowedExtensions.includes(`.${fileExtension}`)) {\n          this.messageService.add({\n            severity: 'warn',\n            summary: 'Arquivo não suportado: Utilize imagens .jpeg, .png ou .jpg'\n          });\n        } else {\n          this.selectedImages = event.target.files;\n          // Limpar o array de imagens\n          for (let i = 0; i < this.selectedImages.length; i++) {\n            const file = this.selectedImages[i];\n            const reader = new FileReader();\n            reader.onload = e => {\n              this.uploadedImages.push({\n                name: file.name,\n                url: e.target.result\n              });\n            };\n            reader.readAsDataURL(file);\n          }\n        }\n      }\n    }\n    fecharModal() {\n      this.ref.close();\n    }\n    addAnimal() {\n      this.loadingService.ativarLoading();\n      this.animalData = {\n        nome: this.animaisFormGroup.get('nome').value,\n        sexo: this.animaisFormGroup.get('sexo').value,\n        raca: this.animaisFormGroup.get('raça').value,\n        cidade: this.animaisFormGroup.get('cidade').value,\n        idade: this.animaisFormGroup.get('idade').value,\n        descricao: this.animaisFormGroup.get('descricao').value,\n        especie: this.animaisFormGroup.get('especie').value\n      };\n      for (const image of this.selectedImages) {\n        this.formDataAnimal.append('imagem', image, image.name);\n      }\n      this.formDataAnimal.append('animal', new Blob([JSON.stringify(this.animalData)], {\n        type: 'application/json'\n      }));\n      if (this.animaisFormGroup.invalid || this.uploadedImages.length === 0) {\n        if (this.uploadedImages.length === 0) {\n          this.messageService.add({\n            severity: 'warn',\n            summary: 'Pelo menos uma imagem deve ser adicionada.'\n          });\n          this.loadingService.desativarLoading();\n        }\n        if (this.animaisFormGroup.invalid) {\n          this.messageService.add({\n            severity: 'warn',\n            summary: 'Campos obrigatórios não informados.'\n          });\n          this.loadingService.desativarLoading();\n        }\n      } else {\n        this.animaisService.adicionarAnimal(this.formDataAnimal).subscribe(response => {\n          this.messageService.add({\n            severity: 'success',\n            summary: 'Animal salvo com sucesso.'\n          });\n          // this.animaisFormGroup.reset()\n          this.loadingService.desativarLoading();\n          this.ref.close();\n        }, error => {\n          error;\n          this.loadingService.desativarLoading();\n        });\n      }\n    }\n    ngAfterViewInit() {}\n    validate(control) {\n      return null;\n    }\n    registerOnValidatorChange(fn) {}\n    writeValue(obj) {}\n    registerOnChange(fn) {}\n    registerOnTouched(fn) {\n      this.onTouched = fn;\n    }\n    setDisabledState(isDisabled) {}\n  }\n  AdicionarAnimalComponent.ɵfac = function AdicionarAnimalComponent_Factory(t) {\n    return new (t || AdicionarAnimalComponent)(i0.ɵɵdirectiveInject(i1.MessageService), i0.ɵɵdirectiveInject(i2.AnimaisService), i0.ɵɵdirectiveInject(i3.LoadingService), i0.ɵɵdirectiveInject(i4.DynamicDialogRef));\n  };\n  AdicionarAnimalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AdicionarAnimalComponent,\n    selectors: [[\"app-adicionar-animal\"]],\n    features: [i0.ɵɵProvidersFeature([FormBuilder, {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => AdicionarAnimalComponent),\n      multi: true\n    }, {\n      provide: NG_VALIDATORS,\n      useExisting: forwardRef(() => AdicionarAnimalComponent),\n      multi: true\n    }])],\n    decls: 60,\n    vars: 3,\n    consts: [[3, \"formGroup\", \"ngSubmit\"], [1, \"add-animal-container\"], [1, \"container-corpo\"], [4, \"ngIf\"], [1, \"div-imagens-upadas\"], [\"class\", \"imagem-upada\", 3, \"src\", \"alt\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"botao-card-editar\", 2, \"margin-top\", \"30px\", \"margin-bottom\", \"40px\", 3, \"click\"], [1, \"pi\", \"pi-upload\"], [\"type\", \"file\", \"accept\", \"image/*\", \"multiple\", \"\", 1, \"hidden-file-input\", 2, \"display\", \"none\", 3, \"change\"], [\"fileInput\", \"\"], [1, \"container-formulario\"], [1, \"campo-form\"], [\"type\", \"text\", \"pInputText\", \"\", \"formControlName\", \"nome\", \"placeholder\", \"Ex: Peludinho\", \"maxlength\", \"40\", 1, \"input-add-animal\"], [\"type\", \"text\", \"pInputText\", \"\", \"formControlName\", \"especie\", \"placeholder\", \"Cachorro, gato, etc.\", \"maxlength\", \"50\", 1, \"input-add-animal\"], [\"type\", \"text\", \"pInputText\", \"\", \"formControlName\", \"ra\\u00E7a\", \"placeholder\", \"Ex: Bulldog\", \"maxlength\", \"50\", 1, \"input-add-animal\"], [\"type\", \"text\", \"pInputText\", \"\", \"formControlName\", \"idade\", \"placeholder\", \"Ex: 1 ano e seis meses\", \"maxlength\", \"50\", 1, \"input-add-animal\"], [2, \"width\", \"198px\"], [1, \"container-radio-button\"], [1, \"caixinha-radio-button\"], [2, \"display\", \"flex\", \"align-items\", \"center\"], [\"type\", \"radio\", \"name\", \"gender\", \"value\", \"Macho\", \"formControlName\", \"sexo\", 2, \"height\", \"18px\", \"width\", \"18px\"], [\"type\", \"radio\", \"name\", \"gender\", \"value\", \"F\\u00EAmea\", \"formControlName\", \"sexo\", 2, \"height\", \"18px\", \"width\", \"18px\"], [\"type\", \"text\", \"pInputText\", \"\", \"formControlName\", \"descricao\", \"placeholder\", \"Ex: Animal d\\u00F3cil e comportado\", \"maxlength\", \"100\", 1, \"input-add-animal\"], [\"type\", \"text\", \"pInputText\", \"\", \"formControlName\", \"cidade\", \"placeholder\", \"Ex: Girassol-GO\", \"maxlength\", \"100\", 1, \"input-add-animal\"], [1, \"container-botoes-add-animal\"], [1, \"caixinha-botoes-add-animal\"], [1, \"botao-fechar\", 3, \"click\"], [\"type\", \"submit\", 1, \"botao-salvar\"], [1, \"imagem-upada\", 3, \"src\", \"alt\"]],\n    template: function AdicionarAnimalComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r4 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function AdicionarAnimalComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.addAnimal();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2);\n        i0.ɵɵtemplate(3, AdicionarAnimalComponent_span_3_Template, 2, 0, \"span\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵtemplate(5, AdicionarAnimalComponent_img_5_Template, 1, 2, \"img\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function AdicionarAnimalComponent_Template_button_click_6_listener() {\n          i0.ɵɵrestoreView(_r4);\n          const _r2 = i0.ɵɵreference(10);\n          return i0.ɵɵresetView(_r2.click());\n        });\n        i0.ɵɵelement(7, \"i\", 7);\n        i0.ɵɵtext(8, \" Selecionar foto \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"input\", 8, 9);\n        i0.ɵɵlistener(\"change\", function AdicionarAnimalComponent_Template_input_change_9_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"div\", 10)(12, \"div\", 11)(13, \"h3\");\n        i0.ɵɵtext(14, \"Nome\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\");\n        i0.ɵɵelement(16, \"input\", 12);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"div\", 11)(18, \"h3\");\n        i0.ɵɵtext(19, \"Especie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\");\n        i0.ɵɵelement(21, \"input\", 13);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(22, \"div\", 11)(23, \"h3\");\n        i0.ɵɵtext(24, \"Ra\\u00E7a\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\");\n        i0.ɵɵelement(26, \"input\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(27, \"div\", 11)(28, \"h3\");\n        i0.ɵɵtext(29, \"Idade\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"div\");\n        i0.ɵɵelement(31, \"input\", 15);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(32, \"div\", 16)(33, \"h3\");\n        i0.ɵɵtext(34, \"Sexo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"div\", 17)(36, \"div\", 18)(37, \"label\", 19);\n        i0.ɵɵelement(38, \"input\", 20);\n        i0.ɵɵtext(39, \"Macho \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(40, \"div\", 18)(41, \"label\", 19);\n        i0.ɵɵelement(42, \"input\", 21);\n        i0.ɵɵtext(43, \"F\\u00EAmea \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(44, \"div\", 11)(45, \"h3\");\n        i0.ɵɵtext(46, \"Descri\\u00E7\\u00E3o\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(47, \"div\");\n        i0.ɵɵelement(48, \"input\", 22);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(49, \"div\", 11)(50, \"h3\");\n        i0.ɵɵtext(51, \"Cidade\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(52, \"div\");\n        i0.ɵɵelement(53, \"input\", 23);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(54, \"div\", 24)(55, \"div\", 25)(56, \"button\", 26);\n        i0.ɵɵlistener(\"click\", function AdicionarAnimalComponent_Template_button_click_56_listener() {\n          return ctx.fecharModal();\n        });\n        i0.ɵɵtext(57, \"Fechar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(58, \"button\", 27);\n        i0.ɵɵtext(59, \"Salvar\");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.animaisFormGroup);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.uploadedImages.length > 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.uploadedImages);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.InputText, i7.ɵNgNoValidate, i7.DefaultValueAccessor, i7.RadioControlValueAccessor, i7.NgControlStatus, i7.NgControlStatusGroup, i7.MaxLengthValidator, i7.FormGroupDirective, i7.FormControlName],\n    styles: [\"::ng-deep .p-dialog{-ms-transform:scale(1);display:flex;flex-direction:column;max-height:90%;position:relative;transform:scale(1);overflow-x:hidden}::ng-deep .p-grid{overflow-x:hidden}::ng-deep .hidden-file-input{display:none}::ng-deep img{height:400px;width:200px!important}.div-imagens-upadas{width:500px;margin-top:30px;display:flex;min-width:330px;margin-bottom:20px;justify-content:space-between;flex-wrap:wrap}.container-corpo{display:flex;width:100%;align-items:center;justify-content:space-evenly;flex-direction:column}.imagem-upada{width:160px;height:180px;border-radius:5px!important;min-width:160px;min-height:180px;margin-bottom:10px}.container-formulario{display:flex;flex-wrap:wrap;justify-content:space-around}.botao-fechar{border:1px solid #2196F3;border-radius:5px;height:39.2px;color:#2196f3;background:white;padding:.5rem 1rem;font-size:1rem;cursor:pointer}.botao-salvar{border:none;border-radius:5px;height:39.2px;color:#fff;background:#2196F3;padding:.5rem 1rem;font-size:1rem;cursor:pointer}.container-botoes-add-animal{display:flex;justify-content:flex-end;margin-top:20px}.caixinha-botoes-add-animal{display:flex;width:200px;justify-content:space-between}.container-radio-button{display:flex;justify-content:space-between;align-items:center;height:35px}.caixinha-radio-button{width:75px;display:flex;justify-content:space-between}.input-add-animal{margin:0;border:1px solid #8e8585!important;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\",Segoe UI Symbol;font-size:1rem;color:#495057;background:#ffffff;padding:.5rem;border:1px solid #ced4da;transition:background-color .2s,color .2s,border-color .2s,box-shadow .2s;-webkit-appearance:none;appearance:none;border-radius:3px}@media screen and (max-width: 975px){.container-botoes-add-animal{display:flex;justify-content:center;margin-top:50px}}\\n\"],\n    encapsulation: 2\n  });\n  return AdicionarAnimalComponent;\n})();\nexport { AdicionarAnimalComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}